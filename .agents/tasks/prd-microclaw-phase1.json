{
  "meta": {
    "title": "MicroClaw Phase 1 (Parity + Hardening)",
    "createdAt": "2026-02-12T23:27:08Z",
    "updatedAt": "2026-02-13T00:18:21Z",
    "minCycles": 5,
    "staleSeconds": 14400
  },
  "stories": [
    {
      "id": "S0",
      "title": "Initialize Ralph state + plan doc",
      "intent": "Create PRD + .ralph state files and track the phase 1 implementation plan doc",
      "acceptance": [
        "PRD JSON exists at .agents/tasks/prd-microclaw-phase1.json",
        ".ralph state files exist and are initialized",
        "Phase 1 implementation plan doc exists"
      ],
      "gates": [
        "test -f .agents/tasks/prd-microclaw-phase1.json",
        "test -f .ralph/progress.md",
        "test -f docs/plans/2026-02-12-microclaw-phase1-implementation-plan.md"
      ],
      "status": "done",
      "startedAt": "2026-02-12T23:28:03Z",
      "completedAt": "2026-02-12T23:28:22Z",
      "dependencies": [],
      "risks": ["None"],
      "notes": "Bootstrap for autonomous loop state"
    },
    {
      "id": "S1",
      "title": "Core workspace + core crate",
      "intent": "Add Rust workspace and core crate with version()",
      "acceptance": ["cargo test -p microclaw-core passes"],
      "gates": ["cargo test -p microclaw-core"],
      "status": "done",
      "startedAt": "2026-02-12T23:00:00Z",
      "completedAt": "2026-02-12T23:05:00Z",
      "dependencies": ["S0"],
      "risks": ["Minimal API coverage"],
      "notes": "Implemented in worktree prior to Ralph loop"
    },
    {
      "id": "S2",
      "title": "Protocol crate (envelope + ids)",
      "intent": "Add microclaw-protocol crate with Envelope and MessageId",
      "acceptance": ["cargo test -p microclaw-protocol passes"],
      "gates": ["cargo test -p microclaw-protocol"],
      "status": "done",
      "startedAt": "2026-02-12T23:05:00Z",
      "completedAt": "2026-02-12T23:10:00Z",
      "dependencies": ["S1"],
      "risks": ["Envelope fields are minimal"],
      "notes": "Implemented in worktree prior to Ralph loop"
    },
    {
      "id": "S3",
      "title": "Config crate defaults",
      "intent": "Add microclaw-config HostConfig with default backend",
      "acceptance": ["cargo test -p microclaw-config passes"],
      "gates": ["cargo test -p microclaw-config"],
      "status": "done",
      "startedAt": "2026-02-12T23:29:04Z",
      "completedAt": "2026-02-12T23:29:39Z",
      "dependencies": ["S2"],
      "risks": ["Config shape may change"],
      "notes": "Keep minimal"
    },
    {
      "id": "S4",
      "title": "Store schema + migrations",
      "intent": "Add microclaw-store with schema_version and in-memory store",
      "acceptance": ["cargo test -p microclaw-store passes"],
      "gates": ["cargo test -p microclaw-store"],
      "status": "done",
      "startedAt": "2026-02-12T23:30:04Z",
      "completedAt": "2026-02-12T23:30:54Z",
      "dependencies": ["S3"],
      "risks": ["Migration layout may change"],
      "notes": "Start with minimal schema_version"
    },
    {
      "id": "S5",
      "title": "Queue per-group FIFO",
      "intent": "Add microclaw-queue GroupQueue with per-group FIFO",
      "acceptance": ["cargo test -p microclaw-queue passes"],
      "gates": ["cargo test -p microclaw-queue"],
      "status": "done",
      "startedAt": "2026-02-12T23:31:24Z",
      "completedAt": "2026-02-12T23:32:26Z",
      "dependencies": ["S4"],
      "risks": ["Capacity semantics may evolve"],
      "notes": "In-memory only"
    },
    {
      "id": "S6",
      "title": "Scheduler due logic",
      "intent": "Add microclaw-scheduler with due()",
      "acceptance": ["cargo test -p microclaw-scheduler passes"],
      "gates": ["cargo test -p microclaw-scheduler"],
      "status": "done",
      "startedAt": "2026-02-12T23:32:48Z",
      "completedAt": "2026-02-12T23:33:30Z",
      "dependencies": ["S5"],
      "risks": ["No recurring semantics yet"],
      "notes": "Minimal once scheduling"
    },
    {
      "id": "S7",
      "title": "Bus idempotency",
      "intent": "Add microclaw-bus with idempotent publish",
      "acceptance": ["cargo test -p microclaw-bus passes"],
      "gates": ["cargo test -p microclaw-bus"],
      "status": "done",
      "startedAt": "2026-02-12T23:34:01Z",
      "completedAt": "2026-02-12T23:34:52Z",
      "dependencies": ["S6"],
      "risks": ["Keying strategy may change"],
      "notes": "In-memory only"
    },
    {
      "id": "S8",
      "title": "Sandbox apple backend stub",
      "intent": "Add microclaw-sandbox with Apple Container backend stub",
      "acceptance": ["cargo test -p microclaw-sandbox passes"],
      "gates": ["cargo test -p microclaw-sandbox"],
      "status": "done",
      "startedAt": "2026-02-12T23:35:20Z",
      "completedAt": "2026-02-12T23:35:58Z",
      "dependencies": ["S7"],
      "risks": ["Real exec not implemented"],
      "notes": "Interface only"
    },
    {
      "id": "S9",
      "title": "Sandbox docker backend stub",
      "intent": "Add Docker backend stub",
      "acceptance": ["cargo test -p microclaw-sandbox passes"],
      "gates": ["cargo test -p microclaw-sandbox"],
      "status": "done",
      "startedAt": "2026-02-12T23:36:27Z",
      "completedAt": "2026-02-12T23:36:59Z",
      "dependencies": ["S8"],
      "risks": ["Real exec not implemented"],
      "notes": "Interface only"
    },
    {
      "id": "S10",
      "title": "Connector trait",
      "intent": "Add microclaw-connectors trait",
      "acceptance": ["cargo test -p microclaw-connectors passes"],
      "gates": ["cargo test -p microclaw-connectors"],
      "status": "done",
      "startedAt": "2026-02-12T23:37:27Z",
      "completedAt": "2026-02-12T23:38:13Z",
      "dependencies": ["S9"],
      "risks": ["Trait shape may evolve"],
      "notes": "Minimal id only"
    },
    {
      "id": "S11",
      "title": "Device scaffold",
      "intent": "Add microclaw-device app scaffold",
      "acceptance": ["cargo test -p microclaw-device --features host passes"],
      "gates": ["cargo test -p microclaw-device --features host"],
      "status": "done",
      "startedAt": "2026-02-12T23:38:45Z",
      "completedAt": "2026-02-12T23:39:19Z",
      "dependencies": ["S10"],
      "risks": ["ESP-IDF integration deferred"],
      "notes": "Host-compile stub"
    },
    {
      "id": "S12",
      "title": "Lockfile + ignore target",
      "intent": "Commit Cargo.lock updates and ignore Rust target directory",
      "acceptance": [
        "Cargo.lock includes workspace members",
        ".gitignore contains target/"
      ],
      "gates": [
        "git diff --exit-code Cargo.lock",
        "rg -n \"^target/$\" .gitignore"
      ],
      "status": "done",
      "startedAt": "2026-02-12T23:40:48Z",
      "completedAt": "2026-02-12T23:41:22Z",
      "dependencies": ["S11"],
      "risks": ["None"],
      "notes": "Housekeeping after Rust workspace expansion"
    },
    {
      "id": "S13",
      "title": "Core routing + trigger policy",
      "intent": "Implement trigger pattern creation and trigger gating logic in microclaw-core",
      "acceptance": [
        "cargo test -p microclaw-core passes",
        "Trigger pattern and gating tests mirror NanoClaw behavior"
      ],
      "gates": ["cargo test -p microclaw-core"],
      "status": "done",
      "startedAt": "2026-02-12T23:47:48Z",
      "completedAt": "2026-02-12T23:49:06Z",
      "dependencies": ["S12"],
      "risks": ["Trigger semantics must match NanoClaw formatting tests"],
      "notes": "Port createTriggerPattern + requiresTrigger gating"
    },
    {
      "id": "S14",
      "title": "Store schema parity",
      "intent": "Expand microclaw-store schema to match NanoClaw groups/messages/tasks/state",
      "acceptance": ["cargo test -p microclaw-store passes"],
      "gates": ["cargo test -p microclaw-store"],
      "status": "done",
      "startedAt": "2026-02-12T23:50:41Z",
      "completedAt": "2026-02-12T23:52:00Z",
      "dependencies": ["S13"],
      "risks": ["Schema drift vs NanoClaw"],
      "notes": "Port tables and accessors from src/db.ts"
    },
    {
      "id": "S15",
      "title": "Bus WAL + replay",
      "intent": "Add durable spool and replay support to microclaw-bus",
      "acceptance": ["cargo test -p microclaw-bus passes"],
      "gates": ["cargo test -p microclaw-bus"],
      "status": "done",
      "startedAt": "2026-02-12T23:52:45Z",
      "completedAt": "2026-02-12T23:54:19Z",
      "dependencies": ["S14"],
      "risks": ["Replay semantics need clarity"],
      "notes": "Add SQLite-backed log and idempotency"
    },
    {
      "id": "S16",
      "title": "Scheduler recurrence + persistence",
      "intent": "Implement cron/interval scheduling with persistence",
      "acceptance": ["cargo test -p microclaw-scheduler passes"],
      "gates": ["cargo test -p microclaw-scheduler"],
      "status": "done",
      "startedAt": "2026-02-12T23:54:49Z",
      "completedAt": "2026-02-12T23:59:37Z",
      "dependencies": ["S15"],
      "risks": ["Cron parsing complexity"],
      "notes": "Mirror NanoClaw scheduled_tasks semantics"
    },
    {
      "id": "S17",
      "title": "Queue concurrency + retry",
      "intent": "Add global concurrency limits and retry/backoff",
      "acceptance": ["cargo test -p microclaw-queue passes"],
      "gates": ["cargo test -p microclaw-queue"],
      "status": "done",
      "startedAt": "2026-02-13T00:00:15Z",
      "completedAt": "2026-02-13T00:02:02Z",
      "dependencies": ["S16"],
      "risks": ["Ordering vs throughput tradeoffs"],
      "notes": "Per-group serialization with global cap"
    },
    {
      "id": "S18",
      "title": "Apple Container runner",
      "intent": "Implement Apple Container backend execution",
      "acceptance": ["cargo test -p microclaw-sandbox passes"],
      "gates": ["cargo test -p microclaw-sandbox"],
      "status": "done",
      "startedAt": "2026-02-13T00:02:20Z",
      "completedAt": "2026-02-13T00:03:01Z",
      "dependencies": ["S17"],
      "risks": ["Local container CLI availability"],
      "notes": "Invoke apple container CLI with mounts"
    },
    {
      "id": "S19",
      "title": "Docker runner parity",
      "intent": "Implement Docker backend execution",
      "acceptance": ["cargo test -p microclaw-sandbox passes"],
      "gates": ["cargo test -p microclaw-sandbox"],
      "status": "done",
      "startedAt": "2026-02-13T00:03:32Z",
      "completedAt": "2026-02-13T00:04:03Z",
      "dependencies": ["S18"],
      "risks": ["Backend differences"],
      "notes": "Parity with Apple runner flags"
    },
    {
      "id": "S20",
      "title": "Mount allowlist + egress deny",
      "intent": "Enforce mount allowlist and deny-by-default egress",
      "acceptance": ["cargo test -p microclaw-sandbox passes"],
      "gates": ["cargo test -p microclaw-sandbox"],
      "status": "done",
      "startedAt": "2026-02-13T00:04:24Z",
      "completedAt": "2026-02-13T00:05:14Z",
      "dependencies": ["S19"],
      "risks": ["Policy errors could block workflows"],
      "notes": "Mirror NanoClaw mount allowlist policy"
    },
    {
      "id": "S21",
      "title": "Secrets broker + audit logs",
      "intent": "Implement secrets injection broker and audit logging",
      "acceptance": ["cargo test -p microclaw-sandbox passes"],
      "gates": ["cargo test -p microclaw-sandbox"],
      "status": "done",
      "startedAt": "2026-02-13T00:05:51Z",
      "completedAt": "2026-02-13T00:06:35Z",
      "dependencies": ["S20"],
      "risks": ["Security-sensitive paths"],
      "notes": "No filesystem-visible secrets by default"
    },
    {
      "id": "S22",
      "title": "iMessage connector",
      "intent": "Implement iMessage send + receive via Messages app",
      "acceptance": ["cargo test -p microclaw-connectors passes"],
      "gates": ["cargo test -p microclaw-connectors"],
      "status": "done",
      "startedAt": "2026-02-13T00:06:55Z",
      "completedAt": "2026-02-13T00:07:49Z",
      "dependencies": ["S21"],
      "risks": ["chat.db schema drift"],
      "notes": "AppleScript send, chat.db tail for receive"
    },
    {
      "id": "S23",
      "title": "Discord connector",
      "intent": "Implement Discord connector using official API",
      "acceptance": ["cargo test -p microclaw-connectors passes"],
      "gates": ["cargo test -p microclaw-connectors"],
      "status": "done",
      "startedAt": "2026-02-13T00:08:20Z",
      "completedAt": "2026-02-13T00:08:46Z",
      "dependencies": ["S22"],
      "risks": ["Rate limit handling"],
      "notes": "Add retry and idempotency"
    },
    {
      "id": "S24",
      "title": "Telegram connector",
      "intent": "Implement Telegram connector using bot API",
      "acceptance": ["cargo test -p microclaw-connectors passes"],
      "gates": ["cargo test -p microclaw-connectors"],
      "status": "done",
      "startedAt": "2026-02-13T00:09:13Z",
      "completedAt": "2026-02-13T00:09:45Z",
      "dependencies": ["S23"],
      "risks": ["Polling/streaming tradeoffs"],
      "notes": "Add retry and idempotency"
    },
    {
      "id": "S25",
      "title": "Email connector",
      "intent": "Implement IMAP/SMTP connector (Gmail API later)",
      "acceptance": ["cargo test -p microclaw-connectors passes"],
      "gates": ["cargo test -p microclaw-connectors"],
      "status": "done",
      "startedAt": "2026-02-13T00:10:11Z",
      "completedAt": "2026-02-13T00:10:39Z",
      "dependencies": ["S24"],
      "risks": ["Provider quirks"],
      "notes": "IMAP IDLE + SMTP send"
    },
    {
      "id": "S26",
      "title": "Device runtime WS + UI shell",
      "intent": "Implement ESP-IDF WS client, reconnect, and UI shell",
      "acceptance": ["cargo test -p microclaw-device --features host passes"],
      "gates": ["cargo test -p microclaw-device --features host"],
      "status": "done",
      "startedAt": "2026-02-13T00:11:05Z",
      "completedAt": "2026-02-13T00:11:37Z",
      "dependencies": ["S25"],
      "risks": ["ESP-IDF integration complexity"],
      "notes": "Host-compile where possible, stub hardware"
    },
    {
      "id": "S27",
      "title": "Sandbox execution runtime",
      "intent": "Execute Apple/Docker runners via std::process and capture output",
      "acceptance": ["cargo test -p microclaw-sandbox passes"],
      "gates": ["cargo test -p microclaw-sandbox"],
      "status": "done",
      "startedAt": "2026-02-13T00:12:30Z",
      "completedAt": "2026-02-13T00:16:01Z",
      "dependencies": ["S26"],
      "risks": ["Local CLI availability"],
      "notes": "Introduce executor trait for testable process spawning"
    },
    {
      "id": "S28",
      "title": "Sandbox policy enforcement",
      "intent": "Enforce MountPolicy/EgressPolicy in runner execution",
      "acceptance": ["cargo test -p microclaw-sandbox passes"],
      "gates": ["cargo test -p microclaw-sandbox"],
      "status": "done",
      "startedAt": "2026-02-13T00:16:12Z",
      "completedAt": "2026-02-13T00:16:59Z",
      "dependencies": ["S27"],
      "risks": ["Policy errors could block workflows"],
      "notes": "Deny-by-default unless allowlisted"
    },
    {
      "id": "S29",
      "title": "iMessage runtime integration",
      "intent": "Implement send via osascript and receive via chat.db polling",
      "acceptance": ["cargo test -p microclaw-connectors passes"],
      "gates": ["cargo test -p microclaw-connectors"],
      "status": "done",
      "startedAt": "2026-02-13T00:17:10Z",
      "completedAt": "2026-02-13T00:18:21Z",
      "dependencies": ["S28"],
      "risks": ["chat.db schema drift"],
      "notes": "Use rusqlite and rowid cursor"
    },
    {
      "id": "S30",
      "title": "Discord runtime integration",
      "intent": "Implement REST send + fetch with retry hooks",
      "acceptance": ["cargo test -p microclaw-connectors passes"],
      "gates": ["cargo test -p microclaw-connectors"],
      "status": "open",
      "startedAt": null,
      "completedAt": null,
      "dependencies": ["S29"],
      "risks": ["Rate limit handling"],
      "notes": "Use blocking HTTP client with mocked tests"
    },
    {
      "id": "S31",
      "title": "Telegram runtime integration",
      "intent": "Implement sendMessage + getUpdates",
      "acceptance": ["cargo test -p microclaw-connectors passes"],
      "gates": ["cargo test -p microclaw-connectors"],
      "status": "open",
      "startedAt": null,
      "completedAt": null,
      "dependencies": ["S30"],
      "risks": ["Long polling"],
      "notes": "Use blocking HTTP client with mocked tests"
    },
    {
      "id": "S32",
      "title": "Email runtime integration",
      "intent": "Implement SMTP send + IMAP idle/poll wrappers",
      "acceptance": ["cargo test -p microclaw-connectors passes"],
      "gates": ["cargo test -p microclaw-connectors"],
      "status": "open",
      "startedAt": null,
      "completedAt": null,
      "dependencies": ["S31"],
      "risks": ["Provider quirks"],
      "notes": "Abstract transport for tests"
    },
    {
      "id": "S33",
      "title": "ESP-IDF runtime wiring",
      "intent": "Add ESP-IDF feature wiring and stubs for Wi-Fi + WS in device runtime",
      "acceptance": ["cargo test -p microclaw-device --features host passes"],
      "gates": ["cargo test -p microclaw-device --features host"],
      "status": "open",
      "startedAt": null,
      "completedAt": null,
      "dependencies": ["S32"],
      "risks": ["ESP-IDF toolchain availability"],
      "notes": "Gate ESP-IDF code under feature flag"
    }
  ]
}
