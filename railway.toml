[build]
# Use the Railway-specific Dockerfile that bundles Node.js + Docker daemon.
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile.railway"

[deploy]
# /health returns HTTP 200 once the Node.js app is listening.
# Railway waits up to 300s for the first healthy response because
# the Docker daemon and agent image need to start first.
healthcheckPath = "/health"
healthcheckTimeout = 300

restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

# ---------------------------------------------------------------------------
# Required environment variables (set in Railway service settings):
#
#   ANTHROPIC_API_KEY   Your Anthropic API key
#   ADMIN_TOKEN         Secret token to protect the /qr auth endpoint
#   ASSISTANT_NAME      Trigger word (default: Andy)
#
# Optional:
#   SKIP_CONTAINER_BUILD=1   Set after first deploy to skip rebuilding the
#                            agent image (use when pulling from a registry)
#   CONTAINER_IMAGE          Agent image name (default: nanoclaw-agent:latest)
#   TZ                       Timezone for cron tasks (e.g. Asia/Jerusalem)
#
# ---------------------------------------------------------------------------
# Required volumes (create in Railway dashboard → service → Volumes):
#
#   Mount path: /app/store    Persists SQLite DB + WhatsApp auth credentials
#   Mount path: /app/groups   Persists per-group CLAUDE.md memory files
#
# ---------------------------------------------------------------------------
# Required service setting:
#
#   Settings → Deploy → Enable "Privileged" mode
#   (needed for the Docker daemon to run inside the container)
# ---------------------------------------------------------------------------
